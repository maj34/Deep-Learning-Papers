# 2. SPPNet

# Spatial Pyramid Pooling in Deep Convolutional Networks for Visual Recognition

**Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun**

# Abstract

í˜„ì¡´í•˜ëŠ” CNNì€ **ê³ ì • í¬ê¸°ì˜ ì…ë ¥ ì´ë¯¸ì§€ë¥¼ ìš”êµ¬**

ì´ëŠ” 'ì¸ìœ„ì 'ì´ë©° ê·¸ ì´ë¯¸ì§€ë‚˜ ì„ì˜ì˜ í¬ê¸°ë¡œ ë³€í™˜ëœ ë¶€ë¶„ ì´ë¯¸ì§€ì— ëŒ€í•œ ì¸ì‹ ì •í™•ë„ë¥¼ í•´ì¹¨

â†’ 'spatial pyramid pooling'ì´ë¼ëŠ” ë‹¤ë¥¸ ë°©ë²•ì„ ì œì‹œ

ì´ë¯¸ì§€ì˜ í¬ê¸°ì— ìƒê´€ì—†ì´ ê³ ì • ê¸¸ì´ì˜ ëŒ€í‘œê°’(representation)ì„ ìƒì„±

pyramid poolingì€ **object ë³€í˜•ì—ë„ ê°•ê±´**í•¨

**Contribution**

- CNN ê¸°ë°˜ì˜ ì´ë¯¸ì§€ classificationì„ ê°œì„ í•˜ì—¬ **ImageNet 2012**ì— ê²°ê³¼ë¥¼ ë³´ì—¬ì¤Œ
- PASCAL VOC 2007 ë° Caltech101 datasetì— ëŒ€í•´ì„œë„ í•˜ë‚˜ì˜ ì´ë¯¸ì§€ ëŒ€í‘œê°’ìœ¼ë¡œ fine-tuning ì—†ì´ë„ ìµœê³ ì˜ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤Œ
- object detectionì—ì„œë„ ê°•ë ¥í•œë°, ì „ì²´ ì´ë¯¸ì§€ì—ì„œ feature mapì„ í•œë²ˆë§Œ ê³„ì‚°í•˜ê³  detectorë¥¼ í•™ìŠµí•˜ê¸° ìœ„í•´ ì„ì˜ì˜ regionì— ëŒ€í•´ ê³ ì • í¬ê¸°ì˜ ëŒ€í‘œê°’ì„ ìƒì„±í•¨
- í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ ì²˜ë¦¬ì‹œì— ì´ ë°©ë²•ì€ **R-CNNë³´ë‹¤ 20~102ë°° ë¹ ë¥´ê³ ** ì •í™•ë„ëŠ” ë¹„ìŠ·í•¨
- ILSVRC 2014ì—ì„œ **detection ë¶€ë¬¸ 2ìœ„**, **classification ë¶€ë¬¸ 3ìœ„**
    
    

# 1. Introduction

ê¸°ì¡´ì˜ CNN ì•„í‚¤í…ì³ë“¤ì€ ëª¨ë‘ **ì…ë ¥ ì´ë¯¸ì§€ê°€ ê³ ì •**ë˜ì–´ì•¼ í–ˆìŒ (ex. 224 x 224) 

â†’ ì‹ ê²½ë§ì„ í†µê³¼ì‹œí‚¤ê¸° ìœ„í•´ì„œëŠ” ì´ë¯¸ì§€ë¥¼ **ê³ ì •ëœ í¬ê¸°ë¡œ í¬ë¡­**í•˜ê±°ë‚˜ **ë¹„ìœ¨ì„ ì¡°ì •**(warp)í•´ì•¼ í•¨

í•˜ì§€ë§Œ ì´ë ‡ê²Œ ë˜ë©´ ë¬¼ì²´ì˜ ì¼ë¶€ë¶„ì´ ì˜ë¦¬ê±°ë‚˜, ë³¸ë˜ì˜ ìƒê¹€ìƒˆì™€ ë‹¬ë¼ì§€ëŠ” ë¬¸ì œì 

***"ì…ë ¥ ì´ë¯¸ì§€ì˜ í¬ê¸°ë‚˜ ë¹„ìœ¨ì— ê´€ê³„ ì—†ì´ CNNì„ í•™ìŠµ ì‹œí‚¬ ìˆ˜ëŠ” ì—†ì„ê¹Œ?"***

![Untitled](2%20SPPNet%2029720/Untitled.png)

Convolution í•„í„°ë“¤ì€ ì‚¬ì‹¤ ì…ë ¥ ì´ë¯¸ì§€ê°€ ê³ ì •ë  í•„ìš”ê°€ ì—†ìŒ

sliding window ë°©ì‹ìœ¼ë¡œ ì‘ë™í•˜ê¸° ë•Œë¬¸ì—, ì…ë ¥ ì´ë¯¸ì§€ì˜ í¬ê¸°ë‚˜ ë¹„ìœ¨ì— ê´€ê³„ ì—†ì´ ì‘ë™í•¨

ì…ë ¥ ì´ë¯¸ì§€ í¬ê¸°ì˜ ê³ ì •ì´ í•„ìš”í•œ ì´ìœ ëŠ” ë°”ë¡œ ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´ë“¤ ë‹¤ìŒì— ì´ì–´ì§€ëŠ” **fully connected layer**ê°€ ê³ ì •ëœ í¬ê¸°ì˜ ì…ë ¥ì„ ë°›ê¸° ë•Œë¬¸

ì—¬ê¸°ì„œ **Spatial Pyramid Pooling(SPP)**ì´ ì œì•ˆë¨

***"ì…ë ¥ ì´ë¯¸ì§€ì˜ í¬ê¸°ì— ê´€ê³„ ì—†ì´ Conv layerë“¤ì„ í†µê³¼ì‹œí‚¤ê³ ,                          FC layer í†µê³¼ì „ì— í”¼ì³ ë§µë“¤ì„ ë™ì¼í•œ í¬ê¸°ë¡œ ì¡°ì ˆí•´ì£¼ëŠ” poolingì„ ì ìš©í•˜ì!"*** 

ì…ë ¥ ì´ë¯¸ì§€ì˜ í¬ê¸°ë¥¼ ì¡°ì ˆí•˜ì§€ ì•Šì€ ì±„ë¡œ ì»¨ë³¼ë£¨ì…˜ì„ ì§„í–‰í•˜ë©´ 

1. **ì›ë³¸ ì´ë¯¸ì§€ì˜ íŠ¹ì§•**ì„ ê³ ìŠ¤ë€íˆ ê°„ì§í•œ í”¼ì³ ë§µì„ ì–»ì„ ìˆ˜ ìˆìŒ
2. ì‚¬ë¬¼ì˜ **í¬ê¸° ë³€í™”ì— ë” ê²¬ê³ **í•œ ëª¨ë¸ì„ ì–»ì„ ìˆ˜ ìˆìŒ
3. Image Classificationì´ë‚˜ Object Detectionê³¼ ê°™ì€ ì—¬ëŸ¬ í…ŒìŠ¤í¬ë“¤ì— **ì¼ë°˜ì ìœ¼ë¡œ ì ìš©**í•  ìˆ˜ ìˆìŒ

<aside>
ğŸ’¡ **ì „ì²´ ì•Œê³ ë¦¬ì¦˜**

1. ë¨¼ì € ì „ì²´ ì´ë¯¸ì§€ë¥¼ ë¯¸ë¦¬ í•™ìŠµëœ **CNNì„ í†µê³¼ì‹œì¼œ í”¼ì³ë§µ**ì„ ì¶”ì¶œí•¨

2. Selective Searchë¥¼ í†µí•´ì„œ ì°¾ì€ ê°ê°ì˜ RoIë“¤ì€ ì œ ê°ê¸° í¬ê¸°ì™€ ë¹„ìœ¨ì´ ë‹¤ë¦„ 

    ì´ì— SPPë¥¼ ì ìš©í•˜ì—¬ **ê³ ì •ëœ í¬ê¸°ì˜ feature vector**ë¥¼ ì¶”ì¶œí•¨

3. ê·¸ ë‹¤ìŒ **fully connected layer**ë“¤ì„ í†µê³¼ ì‹œí‚´

4. ì•ì„œ ì¶”ì¶œí•œ ë²¡í„°ë¡œ ê° ì´ë¯¸ì§€ í´ë˜ìŠ¤ ë³„ë¡œ **binary SVM Classifier**ë¥¼ í•™ìŠµì‹œí‚´

5. ë§ˆì°¬ê°€ì§€ë¡œ ì•ì„œ ì¶”ì¶œí•œ ë²¡í„°ë¡œ **bounding box regressor**ë¥¼ í•™ìŠµì‹œí‚´

</aside>

ë³¸ ë…¼ë¬¸ì˜ ê°€ì¥ í•µì‹¬ì€ Spatial Pyramid Poolingì„ í†µí•´ì„œ **ê°ê¸° í¬ê¸°ê°€ ë‹¤ë¥¸ CNN í”¼ì³ë§µ ì¸í’‹ìœ¼ë¡œë¶€í„° ê³ ì •ëœ í¬ê¸°ì˜ feature vectorë¥¼ ë½‘ì•„ë‚´ëŠ” ê²ƒ**ì— ìˆìŒ

# 2. Deep Networks with Spatial Pyramid Pooling

### 2.1. Convolutional Layers and Feature Maps

![(a) Pascal VOC 2007ì˜ 2ê°œì˜ ì´ë¯¸ì§€
(b) conv5 ì˜ íŠ¹ì • í”¼ì²˜ ë§µ
(c) ëŒ€ì‘í•˜ëŠ” í•„í„°ì˜ ì‘ë‹µì´ ê°€ì¥ ê°•í•œ receptive field](2%20SPPNet%2029720/Untitled%201.png)

(a) Pascal VOC 2007ì˜ 2ê°œì˜ ì´ë¯¸ì§€
(b) conv5 ì˜ íŠ¹ì • í”¼ì²˜ ë§µ
(c) ëŒ€ì‘í•˜ëŠ” í•„í„°ì˜ ì‘ë‹µì´ ê°€ì¥ ê°•í•œ receptive field

convolution ì¸µì€ sliding filtersë¥¼ ì‚¬ìš©í•˜ë©°, ê·¸ ì¶œë ¥ì€ ì…ë ¥ê³¼ ë™ì¼í•œ aspect ratioë¥¼ ê°€ì§

í•„í„°ëŠ” ì˜ë¯¸ ìˆëŠ” content ì— ì˜í•´ì„œ active í•˜ê²Œ ë¨

ex. 55ë²ˆì§¸ í•„í„°(ì™¼ìª½ í•˜ë‹¨)ëŠ” ì› ëª¨ì–‘ìœ¼ë¡œ, 66ë²ˆì§¸ í•„í„°(ì˜¤ë¥¸ìª½ ìƒë‹¨)ëŠ” âˆ§ ëª¨ì–‘, 118ë²ˆì§¸ í•„í„°(ì˜¤ë¥¸ìª½ í•˜ë‹¨)ëŠ” âˆ¨ ëª¨ì–‘ìœ¼ë¡œ ê°€ì¥ í™œì„±í™” ë¨

### 2.2. The Spatial Pyramid Pooling Layer

![SPP Layerê°€ ìˆëŠ” ë„¤íŠ¸ì›Œí¬ êµ¬ì¡°](2%20SPPNet%2029720/Untitled%202.png)

SPP Layerê°€ ìˆëŠ” ë„¤íŠ¸ì›Œí¬ êµ¬ì¡°

1. ë¨¼ì €, Conv Layerë“¤ì„ ê±°ì³ì„œ ì¶”ì¶œëœ **feature mapì„ ì¸í’‹**ìœ¼ë¡œ ë°›ìŒ
2. ê·¸ë¦¬ê³  ì´ë¥¼ ë¯¸ë¦¬ ì •í•´ì ¸ ìˆëŠ” ì˜ì—­ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ì¤Œ 
    
    (ìœ„ì˜ ê²½ìš°, ë¯¸ë¦¬ 4x4, 2x2, 1x1 ì„¸ ê°€ì§€ ì˜ì—­ì„ ì œê³µí•˜ë©°, ê°ê°ì„ í•˜ë‚˜ì˜ **í”¼ë¼ë¯¸ë“œ**ë¼ê³  ë¶€ë¦„. ì¦‰, í•´ë‹¹ ì˜ˆì‹œì—ì„œëŠ” **3ê°œì˜ í”¼ë¼ë¯¸ë“œ**ë¥¼ ì„¤ì •í•œ ê²ƒ, **í”¼ë¼ë¯¸ë“œì˜ í•œ ì¹¸ì„ bin** ì´ë¼ê³  í•¨)
    
    ex. 64 x 64 x 256 í¬ê¸°ì˜ í”¼ì³ ë§µì´ ë“¤ì–´ì˜¨ë‹¤ê³  í–ˆì„ ë•Œ, 4x4ì˜ í”¼ë¼ë¯¸ë“œì˜ binì˜ í¬ê¸°ëŠ” 16x16
    
3. ì´ì œ ê° binì—ì„œ ê°€ì¥ í° ê°’ë§Œ ì¶”ì¶œí•˜ëŠ” **max pooling**ì„ ìˆ˜í–‰í•˜ê³ , ê·¸ ê²°ê³¼ë¥¼ ì­‰ ì´ì–´ë¶™ì—¬ ì¤Œ 
4. ì…ë ¥ í”¼ì³ë§µ **ì±„ë„ í¬ê¸°ë¥¼ k**, **binì˜ ê°œìˆ˜ë¥¼ M**ì´ë¼ê³  í–ˆì„ ë•Œ SPPì˜ ìµœì¢… ì•„ì›ƒí’‹ì€ k*M ì°¨ì› ë²¡í„°
    
    (ìœ„ì˜ ì˜ˆì‹œì—ì„œ k = 256, M = (16 + 4 + 1) = 21)
    

â†’ ì…ë ¥ ì´ë¯¸ì§€ì˜ í¬ê¸°ì™€ ìƒê´€ì—†ì´ **ë¯¸ë¦¬ ì„¤ì •í•œ bin ê°œìˆ˜ì™€ CNN ì±„ë„ ê°’ìœ¼ë¡œ SPPì˜ ì¶œë ¥ì´ ê²°ì •ë¨**

â†’ í•­ìƒ ë™ì¼í•œ í¬ê¸°ì˜ ê²°ê³¼ë¥¼ ë¦¬í„´í•œë‹¤ê³  ë³¼ ìˆ˜ ìˆìŒ 

ì‹¤ì œ ì‹¤í—˜ì—ì„œ ì €ìë“¤ì€ 1x1, 2x2, 3x3, 6x6 ì´ 4ê°œì˜ í”¼ë¼ë¯¸ë“œ, 50ê°œì˜ binìœ¼ë¡œ SPPë¥¼ ì ìš©

### 2.3. Training the Network

ì´ë¡ ì ìœ¼ë¡œ ìœ„ì˜ ë„¤íŠ¸ì›Œí¬ëŠ” **ì…ë ¥ ì´ë¯¸ì§€ í¬ê¸°ì— ê´€ê³„ì—†ì´** í‘œì¤€ back-propagationì„ ì‚¬ìš©í•´ í›ˆë ¨

but, ì‹¤ì œë¡œëŠ” cuda-convnet, Caffeì™€ ê°™ì€ GPU êµ¬í˜„ì‹œ **ê³ ì • ì´ë¯¸ì§€ í¬ê¸°ë¥¼ ì„ í˜¸**í•¨

ë‹¤ìŒì€ SPP ë™ì‘ì„ ìœ ì§€í•˜ë©´ì„œ ì´ëŸ¬í•œ GPU êµ¬í˜„ì˜ ì´ì ì„ ì‚´ë¦¬ëŠ” í•™ìŠµ ë°©ë²•ì„ ê¸°ìˆ í•¨

***Single-size training***

ì´ì „ ì‘ì—…ì²˜ëŸ¼ 224x224ì˜ ê³ ì • í¬ê¸°ë¡œ cropëœ ì´ë¯¸ì§€ë¥¼ ë¨¼ì € ê³ ë ¤í•˜ë©´ cropì€ data ì¦ê°•ì„ ìœ„í•œ ê²ƒ

ì£¼ì–´ì§„ ì´ë¯¸ì§€ í¬ê¸°ì— ëŒ€í•´ ë¨¼ì € SPPì— í•„ìš”í•œ bin ì‚¬ì´ì¦ˆë¥¼ ë¯¸ë¦¬ ê³„ì‚°í•¨

**SPP ì˜ˆì‹œ**

- ROI feature - 13x13
- Spatial bin - 3x3 (pooling ì—°ì‚°ì„ í†µí•´ 3x3 feature mapì„ ì–»ê² ë‹¤ëŠ” ì˜ë¯¸)
- ì•„ë˜ì˜  ROI featureì—ì„œ 3x3 feature mapì„ ì–»ê¸° ìœ„í•´ì„œëŠ” window size =5, stride = 4 ë¡œ ì„¤ì •
- ì•„ë˜ì™€ ê°™ì´ ì„¤ì •ëœ window (ì‘ì€ ë„¤ëª¨ ë°•ìŠ¤)ëŠ” ì´ë™í•˜ë©´ì„œ max pooling ì—°ì‚°ì„ ì ìš©

![SPP ì ìš© ì˜ˆì‹œ](2%20SPPNet%2029720/Untitled%203.png)

SPP ì ìš© ì˜ˆì‹œ

![cuda-convnet í™˜ê²½ì—ì„œ êµ¬í˜„ëœ 3-level pyramid (3x3, 2x2, 1x1)](2%20SPPNet%2029720/Untitled%204.png)

cuda-convnet í™˜ê²½ì—ì„œ êµ¬í˜„ëœ 3-level pyramid (3x3, 2x2, 1x1)

but, ë³´í†µì€ 1x1, 2x2, 4x4 spatial bin ì‚¬ìš©

ë‹¤ì–‘í•œ spatial binì„ ê°€ì§€ê³  ìˆë‹¤ëŠ” ì˜ë¯¸ì—ì„œ Spatial Pyramid ë¼ê³  í•¨

ìœ„ì˜ SPPë¥¼ í†µí•´ 1x1, 2x2, 4x4 spatial bin ì„ ì–»ì—ˆë‹¤ë©´ spatial binì„ ëª¨ë‘ flattení•˜ê²Œ ë¨

ê·¸ëŸ¼ ì´ 16+4+1=21ê°œì˜ featureê°€ ë§Œë“¤ì–´ ì§€ëŠ” ê²ƒ!

21ê°œì˜ ê³ ì •ëœ featureë“¤ì€ fc layerë¡œ ë„˜ì–´ê°€ê²Œ ë¨

***Multi-size training***

![single-size training vs. multi-size training](2%20SPPNet%2029720/Untitled%205.png)

single-size training vs. multi-size training

ë‹¤ì–‘í•œ í¬ê¸°ì˜ ì„œë¡œ ë‹¤ë¥¸ input image sizeë¥¼ ë„£ì–´ ë„¤íŠ¸ì›Œí¬ì˜ **ìˆ˜ë ´ì„ ë¹ ë¥´ê²Œ í•˜ê³  ì„±ëŠ¥ì„ ê°œì„ **í•¨

![Untitled](2%20SPPNet%2029720/Untitled%206.png)

**ì´ë¯¸ì§€ë¥¼ 6ê°œì˜ ìŠ¤ì¼€ì¼** s=(224, 256, 300, 360, 448, 560) ë¡œ ì¡°ì ˆ

ê° ìŠ¤ì¼€ì¼ì— ëŒ€í•´ ì „ì²´ ì´ë¯¸ì§€ì— ëŒ€í•œ feature mapì„ ê³„ì‚°

ì–´ë–¤ ìŠ¤ì¼€ì¼ì—ì„œë“  224x224ë¥¼ ë·° í¬ê¸°ë¡œ ì‚¬ìš©í•˜ì—¬ ì´ ë·°ëŠ” ì›ë˜ ë‹¤ë¥¸ ìŠ¤ì¼€ì¼ì˜ ì´ë¯¸ì§€ì— ëŒ€í•´ ìƒëŒ€ì ìœ¼ë¡œ ë‹¤ë¥¸ í¬ê¸°ë¥¼ ê°€ì§€ê²Œ ë¨ 

ê° ìŠ¤ì¼€ì¼ì— 18ê°œì˜ ë·°ë¥¼ ì‚¬ìš© (4 ì½”ë„ˆì™€ ì¤‘ì•™, ê° ë³€ ì¤‘ì‹¬ì—ì„œ 4ê°œ, ê°ê°ì„ í”Œë¦½)

![Untitled](2%20SPPNet%2029720/Untitled%207.png)

4ê°€ì§€ ë„¤íŠ¸ì›Œí¬ êµ¬ì¡°ë¥¼ í™œìš©í•˜ì—¬ SPP-Netì„ ì ìš©í•œ ê²°ê³¼ ê°œì„ ë˜ëŠ” ì ì„ ì‹¤í—˜

# 3. SPP-Net for Image Classification

### 3.1. Experiments on ImageNet 2012 Classification

### 3.1.1. Baseline Network Architectures

### 3.1.2. Multi-level Pooling Improves Accuracy

![ì„±ëŠ¥ : multi-size trained > single-size trained > no SPP](2%20SPPNet%2029720/Untitled%208.png)

ì„±ëŠ¥ : multi-size trained > single-size trained > no SPP

4ê°œì˜ level pyramid, 50ê°œì˜ bin 

multi-size trainedë¥¼ ì‚¬ìš©í•˜ë©´ parameterë¥¼ ë” ì‚¬ìš©í•˜ë©´ì„œ objectì˜ ë³€í˜•ì— robust ì—ëŸ¬ìœ¨ í–¥ìƒ

![ì„±ëŠ¥ : ì „ì²´ ì´ë¯¸ì§€ > ì˜ë¦° ì´ë¯¸ì§€](2%20SPPNet%2029720/Untitled%209.png)

ì„±ëŠ¥ : ì „ì²´ ì´ë¯¸ì§€ > ì˜ë¦° ì´ë¯¸ì§€

### 3.1.3. Multi-size Training Improves Accuracy

### 3.1.4. Full-image Representations Improve Accuracy

### 3.1.5. Multi-view Testing on Feature Maps

![Untitled](2%20SPPNet%2029720/Untitled%2010.png)

ImageNet 2012 ì—ì„œ ìµœê³  ìˆ˜ì¤€ì´ì—ˆë˜ ëª¨ë¸ë³´ë‹¤ ì—ëŸ¬ìœ¨ í–¥ìƒ

### 3.1.6. Summary and Results for ILSVRC 2014

![Untitled](2%20SPPNet%2029720/Untitled%2011.png)

ILSVRC 2014ì—ì„œ 3ìœ„ì— í•´ë‹¹í•˜ëŠ” ì¢‹ì€ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤Œ

### 3.2. Experiments on VOC 2007 Classification

![Untitled](2%20SPPNet%2029720/Untitled%2012.png)

![Untitled](2%20SPPNet%2029720/Untitled%2013.png)

### 3.3. Experiments on Caltech 101

![Untitled](2%20SPPNet%2029720/Untitled%2014.png)

# 4. SPP-Net for Object Detection

### 4.1. Detection Algorithm

Object Detectionì— SPPë¥¼ ì ìš©í•  ìˆ˜ ìˆìŒ

ì €ìë“¤ì€ R-CNNì˜ ë¬¸ì œì ì„ ì§€ì í•˜ë©° SPPë¥¼ ì´ìš©í•œ ë” íš¨ìœ¨ì ì¸ object detectionì„ ì œì•ˆ 

R-CNNì€ Selective Searchë¡œ ì°¾ì€ 2ì²œê°œì˜ ë¬¼ì²´ ì˜ì—­ì„ ëª¨ë‘ ê³ ì • í¬ê¸°ë¡œ ì¡°ì ˆí•œ ë‹¤ìŒ, ë¯¸ë¦¬ í•™ìŠµëœ CNN ëª¨ë¸ì„ í†µê³¼ì‹œì¼œ featureë¥¼ ì¶”ì¶œ â†’ ì†ë„ê°€ ì—„ì²­ ëŠë ¤ì§

cf) SPPNetì€ ì…ë ¥ ì´ë¯¸ì§€ë¥¼ ê·¸ëŒ€ë¡œ CNNì— í†µê³¼ì‹œì¼œ í”¼ì³ ë§µì„ ì¶”ì¶œí•œ ë‹¤ìŒ, ê·¸ feature mapì—ì„œ 2ì²œê°œì˜ ë¬¼ì²´ ì˜ì—­ì„ ì°¾ì•„ SPPë¥¼ ì ìš©í•˜ì—¬ ê³ ì •ëœ í¬ê¸°ì˜ featureë¥¼ ì–»ì–´ëƒ„

ê·¸ë¦¬ê³  ì´ë¥¼ FCì™€ SVM Classifierì— í†µê³¼ì‹œí‚´

- **R-CNN vs. SPP-Net**
    
    ![R-CNN ë„¤íŠ¸ì›Œí¬ êµ¬ì¡°](2%20SPPNet%2029720/Untitled%2015.png)
    
    R-CNN ë„¤íŠ¸ì›Œí¬ êµ¬ì¡°
    
    ![SPP-Net ë„¤íŠ¸ì›Œí¬ êµ¬ì¡°](2%20SPPNet%2029720/Untitled%2016.png)
    
    SPP-Net ë„¤íŠ¸ì›Œí¬ êµ¬ì¡°
    
    ![R-CNN vs. SPP-net&Fast R-CNN](2%20SPPNet%2029720/Untitled%2017.png)
    
    R-CNN vs. SPP-net&Fast R-CNN
    
    R-CNNì—ì„œëŠ” ì…ë ¥ ì´ë¯¸ì§€ì—ì„œë¶€í„° region proposal ë°©ì‹ì„ ì´ìš©í•´ candidate bounding boxë¥¼ ì„ ë³„í•˜ê³  ëª¨ë“  candidate bounding boxì— ëŒ€í•´ì„œ CNN ì‘ì—…ì„ í•¨
    
    â†’ 2000ê°œì˜ candidate bounding boxê°€ ë‚˜ì˜¤ê²Œ ë˜ë©´ 2000ë²ˆì˜ CNN ê³¼ì •ì„ ìˆ˜í–‰
    
    SPP-Netì€ ì…ë ¥ ì´ë¯¸ì§€ë¥¼ ë¨¼ì € CNN ì‘ì—…ì„ ì§„í–‰í•˜ê³  ë‹¤ì„¯ë²ˆì§¸ conv layerì— ë„ë‹¬í•œ feature mapì„ ê¸°ë°˜ìœ¼ë¡œ region proposal ë°©ì‹ì„ ì ìš©í•´ candidate bounding boxë¥¼ ì„ ë³„
    
    â†’ CNN ì—°ì‚°ì€ 1ë²ˆì´ ë¨
    
    ![Untitled](2%20SPPNet%2029720/Untitled%2018.png)
    
    âˆ´ R-CNN 2000ë²ˆ â†’ SPP-Net 1ë²ˆì˜ CNN Operation ì ˆê°íš¨ê³¼, ì‹œê°„ì„ ë¹ ë¥´ê²Œ ë‹¨ì¶•
    
    ![Training & Test Time](2%20SPPNet%2029720/Untitled%2019.png)
    
    Training & Test Time
    

### 4.2. Detection Results

![Untitled](2%20SPPNet%2029720/Untitled%2020.png)

![Untitled](2%20SPPNet%2029720/Untitled%2021.png)

Pascal VOC 2007 mAP ê²°ê³¼ê°’ 

scaleì„ ë³€í™”ì‹œí‚¤ë©° SPP-Netë¥¼ ì ìš©í•œ ê²°ê³¼

vs. R-CNN ì„ ì´ìš©í•´ fine-tuningê³¼ bounding box regressionì„ ì´ìš©í•œ ê²°ê³¼ ë” ì¢‹ì€ ì„±ëŠ¥

### 4.3. Complexity and Running Time

![Untitled](2%20SPPNet%2029720/Untitled%2022.png)

![Untitled](2%20SPPNet%2029720/Untitled%2023.png)

### 4.4. Model Combination for Detection

### 4.5. ILSVRC 2014 Detection

![Untitled](2%20SPPNet%2029720/Untitled%2024.png)

ILSVRC 2014ì—ì„œ 2ìœ„ì— í•´ë‹¹í•˜ëŠ” ì¢‹ì€ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤Œ

# 5. Conclusion

SPPNetì€ ê¸°ì¡´ R-CNNì´ ëª¨ë“  RoIì— ëŒ€í•´ì„œ CNN inferenceë¥¼ í•œë‹¤ëŠ” ë¬¸ì œì ì„ íšê¸°ì ìœ¼ë¡œ ê°œì„ 

í•˜ì§€ë§Œ ì—¬ì „íˆ í•œê³„ì ì´ ìˆëŠ”ë°, 

1. end-to-end ë°©ì‹ì´ ì•„ë‹ˆë¼ **í•™ìŠµì— ì—¬ëŸ¬ ë‹¨ê³„**ê°€ í•„ìš”í•¨ 

    (fine-tuning, SVM training, Bounding Box Regression)

2. ì—¬ì „íˆ ìµœì¢… í´ë˜ì‹œí”¼ì¼€ì´ì…˜ì€ binary SVM, Region Proposalì€ **Selective Search**ë¥¼ ì´ìš©

3. **fine tuning ì‹œ**ì— SPPë¥¼ ê±°ì¹˜ê¸° ì´ì „ì˜ Conv ë ˆì´ì–´ë“¤ì„ í•™ìŠµ ì‹œí‚¤ì§€ ëª»í•¨

    ë‹¨ì§€ ê·¸ ë’¤ì— **Fully Connnected Layerë§Œ í•™ìŠµ**ì‹œí‚¨ë‹¤.

    â†’ ì €ìë“¤ì€Â ***"for simplicity"***Â Â ë¼ê³ ë§Œ ì„¤ëª…í•¨

# Appendix A

![Untitled](2%20SPPNet%2029720/Untitled%2025.png)

# **Reference**

- **Object Detection ë…¼ë¬¸ íë¦„ ë° ë¦¬ë·°**

[[Object Detection] 1. Object Detection ë…¼ë¬¸ íë¦„ ë° ë¦¬ë·°](https://nuggy875.tistory.com/20)

- **GitHub ë§í¬** (Papers with Code ê¸°ì¤€)

[GitHub - yueruchen/sppnet-pytorch: A simple Spatial Pyramid Pooling layer which could be added in CNN](https://github.com/yueruchen/sppnet-pytorch)

- **ë…¼ë¬¸ ë¦¬ë·° - ìœ íŠœë¸Œ**

[[Paper Review] Introduction to Object Detection Task : Overfeat, RCNN, SPPNet, FastRCNN](https://www.youtube.com/watch?v=SMEtbrqJ2YI)

[ì²œìš°ì§„ - Spatial pyramid pooling in deep convolutional networks for visual recognition](https://www.youtube.com/watch?v=i0lkmULXwe0)

- **ë…¼ë¬¸ ë¦¬ë·° - ë¸”ë¡œê·¸**

[6. SPP Net](https://89douner.tistory.com/89)

[ê°ˆì•„ë¨¹ëŠ” Object Detection [2] Spatial Pyramid Pooling Network](https://yeomko.tistory.com/14)

[[ë…¼ë¬¸ ë¦¬ë·°] SPPnet (2014) ë¦¬ë·°, Spatial Pyramid Pooling Network](https://deep-learning-study.tistory.com/445)

[SPPnet](https://blog.daum.net/sotongman/7)
